import{d as R,o as O,r as T,c,a as u,b as a,e as U,w as $,f as m,g as y,h,F as S,i as B,n as I,t as p,j as q,k as A,l as f,m as g,p as o,q as D,u as w,v as N,s as V}from"./index-DKGscwXy.js";const j={class:"min-h-screen bg-gray-100 py-8"},E={class:"max-w-4xl mx-auto px-4"},F={class:"space-y-6"},J={class:"bg-white rounded-lg shadow p-6"},L={class:"bg-white rounded-lg shadow p-6"},Q={class:"space-y-4"},W={class:"flex gap-4 flex-wrap"},G=["disabled"],H=["disabled"],K=["disabled"],P=["disabled"],X=["disabled"],Y={key:0,class:"space-y-2"},Z={class:"font-medium"},ee={key:1,class:"mt-4"},te={class:"bg-gray-100 p-3 rounded overflow-auto"},ie=R({__name:"DrizzleOrmTest",setup(se){const i=h(!1),l=h([]),d=h([]),t=(e,s)=>{l.value.unshift({type:e,text:s}),l.value.length>10&&l.value.pop()},v=async()=>{i.value=!0;try{await q(),t("success","Database initialized successfully with Drizzle ORM")}catch(e){t("error",`Database initialization failed: ${e.message}`)}finally{i.value=!1}},z=async()=>{i.value=!0;try{await A(),t("success","Database migrations completed successfully with Drizzle schema")}catch(e){t("error",`Migration failed: ${e.message}`)}finally{i.value=!1}},_=async()=>{i.value=!0;try{const e=await f();if(!e)throw new Error("Database not initialized");const s=await e.insert(g).values({name:"Drizzle User",email:`drizzle-${Date.now()}@example.com`,createdAt:new Date().toISOString()}).returning();t("success",`Created user with Drizzle: ${s[0]?.name}`);const n=await e.insert(o).values([{title:"Learn Drizzle ORM",description:"Master Drizzle ORM features",completed:1,userId:s[0]?.id||1,createdAt:new Date().toISOString()},{title:"Build with Relations",description:"Use Drizzle relations for complex queries",completed:0,userId:s[0]?.id||1,createdAt:new Date().toISOString()}]).returning();t("success",`Created ${n.length} tasks with Drizzle`);const r=await e.insert(D).values({name:"Drizzle Context",description:"Context for Drizzle ORM testing",content:"This is a test context content for demonstrating Drizzle ORM capabilities",createdAt:new Date().toISOString()}).returning();t("success",`Created context with Drizzle: ${r[0]?.name}`);const b=await e.select().from(g).where(w(g.name,"Drizzle User")),C=await e.select().from(o).orderBy(N(o.createdAt)),M=await e.select().from(D);d.value=[{type:"filtered_users",data:b},{type:"ordered_tasks",data:C},{type:"contexts",data:M}],t("success","CRUD operations completed successfully with Drizzle ORM")}catch(e){t("error",`CRUD test failed: ${e.message}`)}finally{i.value=!1}},x=async()=>{i.value=!0;try{const e=await f();if(!e)throw new Error("Database not initialized");const s=await e.query.debugUsers.findMany({with:{tasks:!0}});t("success",`Queried ${s.length} users with their tasks using relations`);const n=await e.query.debugTasks.findMany({with:{user:!0}});t("success",`Queried ${n.length} tasks with their users using relations`);const r=await e.select().from(o).innerJoin(g,w(o.userId,g.id)).where(w(o.completed,1));t("success",`Found ${r.length} completed tasks with user info`),d.value=[{type:"users_with_tasks",data:s},{type:"tasks_with_users",data:n},{type:"completed_tasks_joined",data:r}],t("success","Relations and joins tested successfully with Drizzle ORM")}catch(e){t("error",`Relations test failed: ${e.message}`)}finally{i.value=!1}},k=async()=>{i.value=!0;try{await V(),d.value=[],t("success","Database reset completed")}catch(e){t("error",`Database reset failed: ${e.message}`)}finally{i.value=!1}};return O(()=>{t("info","Debug Mode: Disabled"),t("info","This page demonstrates full Drizzle ORM capabilities including relations and schema-driven operations")}),(e,s)=>{const n=T("router-link");return u(),c("div",j,[a("div",E,[s[3]||(s[3]=a("h1",{class:"text-3xl font-bold text-gray-800 mb-8"}," Drizzle ORM Test ",-1)),a("div",F,[a("div",J,[U(n,{to:"/debug",class:"text-blue-600 hover:text-blue-800"},{default:$(()=>[...s[0]||(s[0]=[m(" â† Back to Debug Menu ",-1)])]),_:1})]),a("div",L,[s[2]||(s[2]=a("h2",{class:"text-xl font-semibold mb-4"}," Drizzle ORM Tests (Schema-Driven) ",-1)),a("div",Q,[a("div",W,[a("button",{onClick:v,disabled:i.value,class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 disabled:bg-gray-400"}," Initialize Database ",8,G),a("button",{onClick:z,disabled:i.value,class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 disabled:bg-gray-400"}," Run Migrations ",8,H),a("button",{onClick:_,disabled:i.value,class:"bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 disabled:bg-gray-400"}," Test CRUD Operations ",8,K),a("button",{onClick:x,disabled:i.value,class:"bg-indigo-500 text-white px-4 py-2 rounded hover:bg-indigo-600 disabled:bg-gray-400"}," Test Relations & Joins ",8,P),a("button",{onClick:k,disabled:i.value,class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 disabled:bg-gray-400"}," Reset Database ",8,X)]),l.value.length>0?(u(),c("div",Y,[(u(!0),c(S,null,B(l.value,(r,b)=>(u(),c("div",{key:b,class:I(["p-3 rounded",r.type==="success"?"bg-green-100 text-green-800":r.type==="error"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"])},[a("span",Z,p(r.type.toUpperCase())+":",1),m(" "+p(r.text),1)],2))),128))])):y("",!0),d.value.length>0?(u(),c("div",ee,[s[1]||(s[1]=a("h3",{class:"font-semibold mb-2"},"Test Data:",-1)),a("pre",te,p(JSON.stringify(d.value,null,2)),1)])):y("",!0)])])])])])}}});export{ie as default};
