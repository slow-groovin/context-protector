import{d as k,o as F,r as C,c as r,a as i,b as t,e as L,w as D,f as O,h as w,F as h,i as x,g as S,t as l}from"./index-DKGscwXy.js";const $={class:"min-h-screen bg-gray-100 py-8"},V={class:"max-w-6xl mx-auto px-4"},P={class:"space-y-6"},B={class:"bg-white rounded-lg shadow p-6"},H={class:"bg-white rounded-lg shadow p-6"},E={key:0,class:"text-gray-500"},M={key:1,class:"space-y-2"},N={class:"flex justify-between items-center"},z={class:"font-medium"},R={class:"text-sm text-gray-600"},U={class:"text-sm text-gray-600"},j={class:"space-x-2"},T=["onClick"],I=["onClick"],q={key:0,class:"mt-4"},A={class:"bg-gray-50 p-3 rounded text-sm overflow-x-auto"},G={class:"bg-white rounded-lg shadow p-6"},J={id:"logs",class:"bg-black text-green-400 p-4 rounded font-mono text-sm max-h-60 overflow-y-auto"},W=k({__name:"OpfsViewer",setup(K){const u=w([]),d=w([]);let m=0;const n=o=>{d.value.push({id:++m,timestamp:new Date().toLocaleTimeString(),message:o}),d.value.length>20&&d.value.shift()},f=()=>{d.value=[],m=0},b=async()=>{try{n("Loading OPFS contents...");const o=await navigator.storage.getDirectory(),e=[];for await(const[c,s]of o.entries())if(s.kind==="file"){const a=await s.getFile();e.push({name:c,size:a.size,lastModified:a.lastModified})}u.value=e,n(`Found ${e.length} files`)}catch(o){n(`Error loading OPFS: ${o}`),console.error("OPFS error:",o)}},v=async o=>{try{n(`Viewing file: ${o.name}`);const a=await(await(await(await navigator.storage.getDirectory()).getFileHandle(o.name)).getFile()).text();o.content=a,n(`Loaded content for ${o.name}`)}catch(e){n(`Error viewing file ${o.name}: ${e}`),console.error("View file error:",e)}},y=async o=>{try{n(`Downloading file: ${o.name}`);const a=await(await(await(await navigator.storage.getDirectory()).getFileHandle(o.name)).getFile()).arrayBuffer(),_=new Blob([a]),p=URL.createObjectURL(_),g=document.createElement("a");g.href=p,g.download=o.name,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(p),n(`Downloaded ${o.name}`)}catch(e){n(`Error downloading file ${o.name}: ${e}`),console.error("Download file error:",e)}};return F(()=>{n("OPFS Viewer component mounted"),b()}),(o,e)=>{const c=C("router-link");return i(),r("div",$,[t("div",V,[e[6]||(e[6]=t("h1",{class:"text-3xl font-bold text-gray-800 mb-8"},"OPFS Viewer",-1)),t("div",P,[t("div",B,[L(c,{to:"/debug",class:"text-blue-600 hover:text-blue-800"},{default:D(()=>[...e[0]||(e[0]=[O(" â† Back to Debug Page ",-1)])]),_:1})]),t("div",{class:"bg-white rounded-lg shadow p-6"},[e[1]||(e[1]=t("h2",{class:"text-xl font-semibold mb-4"},"Controls",-1)),t("div",{class:"space-y-2"},[t("button",{onClick:b,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Load OPFS Contents "),t("button",{onClick:f,class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded ml-2"}," Clear Logs ")])]),t("div",H,[e[3]||(e[3]=t("h2",{class:"text-xl font-semibold mb-4"},"OPFS Files",-1)),u.value.length===0?(i(),r("div",E," No files found or not loaded yet. ")):(i(),r("div",M,[(i(!0),r(h,null,x(u.value,s=>(i(),r("div",{key:s.name,class:"border border-gray-200 rounded p-4"},[t("div",N,[t("div",null,[t("h3",z,l(s.name),1),t("p",R,"Size: "+l(s.size)+" bytes",1),t("p",U,"Last Modified: "+l(new Date(s.lastModified).toLocaleString()),1)]),t("div",j,[t("button",{onClick:a=>v(s),class:"bg-green-500 hover:bg-green-700 text-white text-sm py-1 px-3 rounded"}," View Content ",8,T),t("button",{onClick:a=>y(s),class:"bg-purple-500 hover:bg-purple-700 text-white text-sm py-1 px-3 rounded"}," Download ",8,I)])]),s.content?(i(),r("div",q,[e[2]||(e[2]=t("h4",{class:"font-medium mb-2"},"Content:",-1)),t("pre",A,l(s.content),1)])):S("",!0)]))),128))]))]),t("div",G,[e[5]||(e[5]=t("h2",{class:"text-xl font-semibold mb-4"},"Logs",-1)),t("div",J,[e[4]||(e[4]=t("p",null,"OPFS Viewer Loaded",-1)),(i(!0),r(h,null,x(d.value,s=>(i(),r("p",{key:s.id},l(s.timestamp)+": "+l(s.message),1))),128))])])])])])}}});export{W as default};
