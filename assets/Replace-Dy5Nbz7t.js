import{d as U,h as g,x as G,c as h,a as v,b as e,y as w,z as k,F as D,i as W,t as u,f as R,A as $,B,g as P,C as J,l as I,D as b,u as E,E as K,j as Q,k as X,G as Y,H as Z,I as V}from"./index-DKGscwXy.js";const ee={class:"min-h-screen bg-gray-100 py-8"},te={class:"max-w-6xl mx-auto px-4"},le={class:"grid grid-cols-2 gap-8"},oe={class:"bg-white rounded-lg shadow p-6"},se={class:"mt-4 space-y-2"},ae={class:"grid grid-cols-5 gap-2"},re=["onClick"],ne={class:"bg-white rounded-lg shadow p-6"},ie=["innerHTML"],de={class:"mt-8 grid grid-cols-2 gap-8"},ue={class:"bg-white rounded-lg shadow p-6"},ce={class:"bg-white rounded-lg shadow p-6"},pe=["innerHTML"],ge={class:"mt-8 grid grid-cols-2 gap-8"},he={class:"bg-white rounded-lg shadow p-6"},ve={class:"bg-white rounded-lg shadow p-6"},me={class:"mb-4"},be={key:0,class:"text-gray-500 italic mt-2"},xe={key:1,class:"mt-2 space-y-2 max-h-64 overflow-auto"},ye={class:"mt-8 bg-white rounded-lg shadow p-6"},fe={class:"mb-6 p-4 border border-gray-200 rounded-lg"},we={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ke={class:"space-y-4"},Re={key:0,class:"text-gray-500 italic"},Me={class:"flex justify-between items-start"},Te={class:"flex-1"},Ie={class:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm"},Ce={class:"flex space-x-2 ml-4"},De=["onClick"],We=["onClick"],Ne=U({__name:"Replace",setup(Ee){const c=g(G()),M=g(""),z=g(""),p=g(""),C=g([]),T=g(""),x=g(""),n=g(""),i=g({match:{type:"fixed",value:""},target:{type:"fixed",value:""}}),y=async()=>{p.value=`task-${Date.now()}-${Math.random().toString(36).substring(2,9)}`;const o=J(M.value,c.value);if(z.value=o.result,C.value=o.history,o.history.length>0)try{const t=await I();if(!t){console.error("Database not initialized");return}const l=o.history.map(s=>({taskId:p.value,originalMatch:s.originalMatch,originalMatchType:s.originalMatchType,replacedWith:s.replacedWith,replacedWithType:s.replacedWithType,ruleId:s.ruleId,createdAt:new Date().toISOString()}));await t.insert(b).values(l)}catch(t){console.error("Failed to save replacement history:",t)}},j=async()=>{if(!p.value||!T.value){x.value="No replacement history or input text available.";return}const o=p.value;try{const t=await I();if(!t){x.value="Database not initialized.";return}const l=await t.select().from(b).where(E(b.taskId,o));if(l.length===0){x.value="No replacement history found for current task.";return}let s=T.value;l.forEach(d=>{let m;d.replacedWithType==="regex"?m=new RegExp(d.replacedWith,"g"):m=new RegExp(K(d.replacedWith),"g"),s=s.replace(m,d.originalMatch)}),x.value=s}catch(t){console.error("Failed to restore content:",t),x.value="Error occurred during restore. Check console for details."}},F=async()=>{if(!p.value){n.value="No replacement history available. Please perform a replace first.";return}try{const o=await I();if(!o){n.value="Database not initialized.";return}const t=await o.select().from(b).where(E(b.taskId,p.value));if(t.length===0){n.value="No replacement history found.";return}const l=["一","二","三","四"],s=[...new Set(t.map(r=>r.replacedWith))],d=[...s,...l],m=s.length*(Math.floor(Math.random()*5)+1),a=[];for(a.push(...s);a.length<m;){const r=Math.floor(Math.random()*d.length);a.push(d[r])}for(let r=a.length-1;r>0;r--){const f=Math.floor(Math.random()*(r+1));!a[r]||!a[f]||([a[r],a[f]]=[a[f],a[r]])}n.value=a.join("")}catch(o){console.error("Failed to generate mock Chinese:",o),n.value="Error generating mock output."}},S=async()=>{if(!p.value){n.value="No replacement history available. Please perform a replace first.";return}try{const o=await I();if(!o){n.value="Database not initialized.";return}const t=await o.select().from(b).where(E(b.taskId,p.value));if(t.length===0){n.value="No replacement history found.";return}const l=["my","you","this","what","can","do"],s=[...new Set(t.map(r=>r.replacedWith))],d=[...s,...l],m=s.length*(Math.floor(Math.random()*5)+1),a=[];for(a.push(...s);a.length<m;){const r=Math.floor(Math.random()*d.length);a.push(d[r])}for(let r=a.length-1;r>0;r--){const f=Math.floor(Math.random()*(r+1));[a[r],a[f]]=[a[f],a[r]]}n.value=a.join(" ")}catch(o){console.error("Failed to generate mock English:",o),n.value="Error generating mock output."}},H=["hello world","This is a test string.","hello test world","Replace hello and test.","world test hello","Multiple hello world test instances.",`var x = 5;
let y = 10;
function foo() {
  var z = x + y;
  return react.component;
}
var react = require('react');`,'import from /src/utils.js; const file = "/src/index.js";',"你好，世界！这是我的世界的你好。世界很大，的的的。","The quick brown fox jumps over the lazy dog. The dog is lazy, and the fox is quick. The the the."],_=o=>{M.value=H[o-1]||"",y()},A=async()=>{try{await Q(),await X(),alert("Database tables initialized successfully!")}catch(o){console.error("Failed to initialize database:",o),alert("Failed to initialize database. Check console for details.")}},L=()=>{c.value=Y(),y()},q=()=>{const o={id:Z(),match:{...i.value.match},target:{...i.value.target}};c.value.push(o),V(c.value),i.value={match:{type:"fixed",value:""},target:{type:"fixed",value:""}},y()},N=o=>{c.value=c.value.filter(t=>t.id!==o),V(c.value),y()},O=o=>{i.value.match={...o.match},i.value.target={...o.target},N(o.id)};return y(),(o,t)=>(v(),h("div",ee,[e("div",te,[t[29]||(t[29]=e("h1",{class:"text-3xl font-bold text-gray-800 mb-8"},"Replace Tool",-1)),e("div",le,[e("div",oe,[t[6]||(t[6]=e("h2",{class:"text-xl font-semibold mb-4"},"Input Text",-1)),w(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=l=>M.value=l),class:"w-full h-64 p-4 border border-gray-300 rounded-lg resize-none",placeholder:"Enter text to replace..."},null,512),[[k,M.value]]),e("div",se,[e("button",{onClick:y,class:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700"}," Do Replace "),e("div",ae,[(v(),h(D,null,W(10,l=>e("button",{key:l,onClick:s=>_(l),class:"bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300"}," Test "+u(l),9,re)),64))])])]),e("div",ne,[t[7]||(t[7]=e("h2",{class:"text-xl font-semibold mb-4"},"Replaced Text",-1)),e("div",{class:"h-64 p-4 border border-gray-300 rounded-lg overflow-auto whitespace-pre-wrap",innerHTML:z.value},null,8,ie)])]),e("div",de,[e("div",ue,[t[8]||(t[8]=e("h2",{class:"text-xl font-semibold mb-4"}," AI Model Output (for Restore) ",-1)),w(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=l=>T.value=l),class:"w-full h-64 p-4 border border-gray-300 rounded-lg resize-none",placeholder:"Paste AI model response content here..."},null,512),[[k,T.value]]),e("div",{class:"mt-4"},[e("button",{onClick:j,class:"w-full bg-orange-600 text-white py-2 px-4 rounded-lg hover:bg-orange-700"}," Do Restore ")])]),e("div",ce,[t[9]||(t[9]=e("h2",{class:"text-xl font-semibold mb-4"},"Restored Content",-1)),e("div",{class:"h-64 p-4 border border-gray-300 rounded-lg overflow-auto whitespace-pre-wrap",innerHTML:x.value},null,8,pe)])]),e("div",ge,[e("div",he,[t[10]||(t[10]=e("h2",{class:"text-xl font-semibold mb-4"}," Mock AI Output Generator ",-1)),e("div",{class:"mb-4 space-y-2"},[e("div",{class:"grid grid-cols-2 gap-2"},[e("button",{onClick:F,class:"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700"}," Generate Chinese Mock "),e("button",{onClick:S,class:"bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700"}," Generate English Mock ")]),e("button",{onClick:A,class:"w-full bg-orange-600 text-white py-2 px-4 rounded-lg hover:bg-orange-700"}," Initialize Database Tables ")]),w(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>n.value=l),readonly:"",class:"w-full h-32 p-4 border border-gray-300 rounded-lg resize-none bg-gray-50",placeholder:"Generated mock output will appear here..."},null,512),[[k,n.value]])]),e("div",ve,[t[16]||(t[16]=e("h2",{class:"text-xl font-semibold mb-4"}," Current Task Information ",-1)),e("div",me,[t[11]||(t[11]=e("strong",null,"Task ID:",-1)),R(" "+u(p.value||"No task yet"),1)]),e("div",null,[t[15]||(t[15]=e("strong",null,"Replacement History:",-1)),C.value.length===0?(v(),h("div",be," No replacements performed yet. ")):(v(),h("div",xe,[(v(!0),h(D,null,W(C.value,(l,s)=>(v(),h("div",{key:s,class:"p-2 border border-gray-200 rounded text-sm"},[e("div",null,[t[12]||(t[12]=e("strong",null,"Rule ID:",-1)),R(" "+u(l.ruleId),1)]),e("div",null,[t[13]||(t[13]=e("strong",null,"Original:",-1)),e("code",null,u(l.originalMatch),1),R(" ("+u(l.originalMatchType)+") ",1)]),e("div",null,[t[14]||(t[14]=e("strong",null,"Replaced:",-1)),e("code",null,u(l.replacedWith),1),R(" ("+u(l.replacedWithType)+") ",1)])]))),128))]))])])]),e("details",ye,[t[28]||(t[28]=e("summary",{class:"cursor-pointer text-xl font-semibold mb-4"}," Replace Rules Configuration ",-1)),e("div",{class:"mb-6 space-y-4"},[e("div",null,[e("button",{onClick:L,class:"bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700"}," Restore Default Rules "),t[17]||(t[17]=e("p",{class:"text-sm text-gray-600 mt-2"}," This will restore the default test rules (IDs 1-10) without affecting your custom rules. ",-1))])]),e("div",fe,[t[23]||(t[23]=e("h3",{class:"text-lg font-medium mb-4"},"Add New Rule",-1)),e("form",{onSubmit:$(q,["prevent"]),class:"space-y-4"},[e("div",we,[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium mb-1"},"Match Type",-1)),w(e("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>i.value.match.type=l),class:"w-full p-2 border border-gray-300 rounded"},[...t[18]||(t[18]=[e("option",{value:"fixed"},"Fixed String",-1),e("option",{value:"regex"}," Regular Expression ",-1)])],512),[[B,i.value.match.type]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium mb-1"},"Match Value",-1)),w(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>i.value.match.value=l),type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded",placeholder:"Value to match"},null,512),[[k,i.value.match.value]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium mb-1"},"Replace With",-1)),w(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>i.value.target.value=l),type:"text",required:"",class:"w-full p-2 border border-gray-300 rounded",placeholder:"Replacement text"},null,512),[[k,i.value.target.value]])])]),t[22]||(t[22]=e("button",{type:"submit",class:"bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700"}," Add Rule ",-1))],32)]),e("div",ke,[t[27]||(t[27]=e("h3",{class:"text-lg font-medium"},"Current Rules",-1)),c.value.length===0?(v(),h("div",Re," No rules configured yet. ")):P("",!0),(v(!0),h(D,null,W(c.value,l=>(v(),h("div",{key:l.id,class:"p-4 border border-gray-200 rounded-lg"},[e("div",Me,[e("div",Te,[e("div",Ie,[e("div",null,[t[24]||(t[24]=e("strong",null,"Type:",-1)),R(" "+u(l.match.type),1)]),e("div",null,[t[25]||(t[25]=e("strong",null,"Match:",-1)),e("code",null,u(l.match.value),1)]),e("div",null,[t[26]||(t[26]=e("strong",null,"Replace:",-1)),e("code",null,u(l.target.value),1)])])]),e("div",Ce,[e("button",{onClick:s=>O(l),class:"bg-blue-500 text-white py-1 px-3 rounded hover:bg-blue-600"}," Edit ",8,De),e("button",{onClick:s=>N(l.id),class:"bg-red-500 text-white py-1 px-3 rounded hover:bg-red-600"}," Delete ",8,We)])])]))),128))])])])]))}});export{Ne as default};
