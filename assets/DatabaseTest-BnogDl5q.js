import{d as k,o as T,r as S,c as l,a as i,b as t,e as U,w as $,f as p,g as m,h as b,F as M,i as z,n as B,t as g,j as O,k as R,l as I,m as v,p as y,q as h,s as N}from"./index-DKGscwXy.js";const F={class:"min-h-screen bg-gray-100 py-8"},V={class:"max-w-4xl mx-auto px-4"},A={class:"space-y-6"},E={class:"bg-white rounded-lg shadow p-6"},L={class:"bg-white rounded-lg shadow p-6"},P={class:"space-y-4"},j={class:"flex gap-4"},q=["disabled"],J=["disabled"],Q=["disabled"],G=["disabled"],H={key:0,class:"space-y-2"},K={class:"font-medium"},W={key:1,class:"mt-4"},X={class:"bg-gray-100 p-3 rounded overflow-auto"},ee=k({__name:"DatabaseTest",setup(Y){const a=b(!1),r=b([]),d=b([]),o=(e,s)=>{r.value.unshift({type:e,text:s}),r.value.length>10&&r.value.pop()},f=async()=>{a.value=!0;try{await O(),o("success","Database initialized successfully with OPFS support")}catch(e){o("error",`Database initialization failed: ${e.message}`)}finally{a.value=!1}},x=async()=>{a.value=!0;try{await R(),o("success","Database migrations completed successfully")}catch(e){o("error",`Migration failed: ${e.message}`)}finally{a.value=!1}},_=async()=>{a.value=!0;try{const e=await I();if(!e)throw new Error("Database not initialized");const s=await e.insert(v).values({name:"Test User",email:`test-${Date.now()}@example.com`,createdAt:new Date().toISOString()}).returning();o("success",`Created user: ${s[0]?.name}`);const c=await e.insert(y).values({title:"Test Task",description:"This is a test task",completed:0,userId:s[0]?.id||1,createdAt:new Date().toISOString()}).returning();o("success",`Created task: ${c[0]?.title}`);const n=await e.insert(h).values({name:"Test Context",description:"This is a test context",content:"Sample context content for testing",createdAt:new Date().toISOString()}).returning();o("success",`Created context: ${n[0]?.name}`);const u=await e.select().from(v),D=await e.select().from(y),C=await e.select().from(h);d.value=[{type:"users",data:u},{type:"tasks",data:D},{type:"contexts",data:C}],o("success","CRUD operations completed successfully")}catch(e){o("error",`CRUD test failed: ${e.message}`)}finally{a.value=!1}},w=async()=>{a.value=!0;try{await N(),d.value=[],o("success","Database reset completed")}catch(e){o("error",`Database reset failed: ${e.message}`)}finally{a.value=!1}};return T(()=>{o("info","Debug Mode: Disabled")}),(e,s)=>{const c=S("router-link");return i(),l("div",F,[t("div",V,[s[3]||(s[3]=t("h1",{class:"text-3xl font-bold text-gray-800 mb-8"}," Database Tests ",-1)),t("div",A,[t("div",E,[U(c,{to:"/debug",class:"text-blue-600 hover:text-blue-800"},{default:$(()=>[...s[0]||(s[0]=[p(" â† Back to Debug Menu ",-1)])]),_:1})]),t("div",L,[s[2]||(s[2]=t("h2",{class:"text-xl font-semibold mb-4"}," Database Tests (SQLocal + Drizzle + OPFS) ",-1)),t("div",P,[t("div",j,[t("button",{onClick:f,disabled:a.value,class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 disabled:bg-gray-400"}," Initialize Database ",8,q),t("button",{onClick:x,disabled:a.value,class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 disabled:bg-gray-400"}," Run Migrations ",8,J),t("button",{onClick:_,disabled:a.value,class:"bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 disabled:bg-gray-400"}," Test CRUD Operations ",8,Q),t("button",{onClick:w,disabled:a.value,class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 disabled:bg-gray-400"}," Reset Database ",8,G)]),r.value.length>0?(i(),l("div",H,[(i(!0),l(M,null,z(r.value,(n,u)=>(i(),l("div",{key:u,class:B(["p-3 rounded",n.type==="success"?"bg-green-100 text-green-800":n.type==="error"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"])},[t("span",K,g(n.type.toUpperCase())+":",1),p(" "+g(n.text),1)],2))),128))])):m("",!0),d.value.length>0?(i(),l("div",W,[s[1]||(s[1]=t("h3",{class:"font-semibold mb-2"},"Test Data:",-1)),t("pre",X,g(JSON.stringify(d.value,null,2)),1)])):m("",!0)])])])])])}}});export{ee as default};
